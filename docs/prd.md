# Product Requirements Document — Ghostpen v0.1

## Scope

v0.1 — CLI-агент для одного користувача. Без UI, без бази даних, без мультиюзерності. Мета: працюючий прототип, який приносить реальну користь автору щодня.

---

## User Stories

### US-1: Створення персонального Style Profile
> "Навчи агента писати як я"

**Як** творець контенту,
**я хочу** дати агенту свої найкращі пости,
**щоб** він зрозумів мій стиль і міг писати схоже.

**Сценарій:**
1. Користувач запускає `ghostpen init`
2. Агент просить вставити 10-20 текстів
3. Агент аналізує тексти і створює `data/profiles/default.json`
4. Агент показує summary: "Твій стиль: дружній але експертний, короткі рубані речення, часто починаєш з провокативного питання, уникаєш канцеляризмів і emoji"
5. Користувач коригує: "Я іноді використовую emoji, додай це" → профіль оновлюється

**Acceptance Criteria:**
- Профіль створюється з `profile_type: "personal"` і `profile_name: "default"`
- Містить: tone, formality, personality, sentence_style, paragraph_style, hooks, closings, signature_phrases, avoid, emoji_usage
- Містить platform-specific rules (LinkedIn vs Instagram vs X)
- Секція `examples` зберігає 3-5 найкращих постів як референси з поясненням `why_good`
- Summary написаний зрозумілою мовою, не JSON
- Весь процес займає < 3 хвилини

**Priority:** P0

---

### US-2: Створення reference-профілю конкурента
> "Хочу зрозуміти як він пише"

**Як** творець контенту,
**я хочу** створити профіль стилю іншого автора,
**щоб** аналізувати його прийоми і вчитися у нього.

**Сценарій:**
1. Користувач: `ghostpen profile create competitor-alex`
2. Агент просить вставити 10-15 постів цього автора (copy-paste)
3. Агент аналізує і створює `data/profiles/competitor-alex.json`
4. Показує summary стилю: "Alex пише: впевнений тон, довгі наративні абзаци, починає з особистої історії, уникає прямих CTA"
5. Користувач може підкоригувати якщо знає автора краще ніж видно з текстів

**Acceptance Criteria:**
- Профіль створюється з `profile_type: "reference"`
- `source` фіксує звідки взяті тексти
- Та сама структура що й personal профіль
- Reference профіль НЕ еволюціонує з фідбеком автоматично
- Оновлюється тільки коли користувач явно додає нові пости або редагує вручну
- Команда `ghostpen profile list` показує всі профілі з типами

**Priority:** P1

---

### US-3: Генерація поста
> "Напиши пост — але як я б написав"

**Як** творець контенту,
**я хочу** дати тему і отримати готову чернетку у моєму стилі,
**щоб** скоротити час написання з 2 годин до 15 хвилин.

**Сценарій:**
1. Користувач: `ghostpen "пост про вигорання для LinkedIn"`
2. Агент автономно вирішує план дій:
    - Завжди: читає style profile (default або вказаний через `--profile`)
    - Якщо потрібно: шукає свіжу статистику/факти в вебі
    - Якщо є: перевіряє минулі пости на схожу тему
3. Генерує чернетку відповідно до platform rules
4. Виводить результат і чекає фідбек

**Acceptance Criteria:**
- Агент ЗАВЖДИ читає style profile перед генерацією (не опціонально)
- Вибір додаткових tools — автономний, на основі контексту
- Результат відповідає platform-specific обмеженням (довжина, структура)
- Чернетка зберігається в `data/output/` з датою і темою в назві файлу
- Час від запиту до чернетки: < 30 секунд
- Якість: < 30% правок потрібно для публікації

**Priority:** P0

---

### US-4: Генерація у стилі конкурента
> "Напиши як Alex"

**Як** творець контенту,
**я хочу** згенерувати пост у стилі іншого автора,
**щоб** зрозуміти його підхід зсередини і поекспериментувати.

**Сценарій:**
1. Користувач: `ghostpen "пост про AI тренди" --profile competitor-alex`
2. Агент читає `competitor-alex.json` замість `default.json`
3. Генерує пост повністю у стилі Alex

**Acceptance Criteria:**
- `--profile <name>` перемикає активний профіль для цієї генерації
- Якщо профіль не знайдений → зрозуміле повідомлення + `ghostpen profile list`
- Фідбек на цю генерацію НЕ оновлює reference профіль
- В metadata збереженого файлу вказано який профіль використано

**Priority:** P1

---

### US-5: Mix Mode — мій голос + чужі прийоми
> "Хочу звучати як я, але з його структурою"

**Як** творець контенту,
**я хочу** комбінувати свій стиль з прийомами іншого автора,
**щоб** покращити свій контент не втрачаючи автентичності.

**Сценарій:**
1. Користувач: `ghostpen "пост про найм" --mix default competitor-alex`
2. Агент читає обидва профілі
3. Бере з першого (base): tone, formality, personality, avoid, emoji_usage, signature_phrases
4. Бере з другого (techniques): hooks, closings, sentence_style, paragraph_style, structure
5. Генерує гібридний пост

**Acceptance Criteria:**
- `--mix` приймає рівно два імені профілів: base + techniques
- Перший профіль = голос і характер, другий = технічні прийоми
- Результат звучить як автор першого профілю, але використовує структуру другого
- Агент в output пояснює що саме він запозичив: "Використав hook-стиль Alex (особиста історія) + твій тон і signature phrases"
- Фідбек оновлює тільки personal профіль (якщо base = personal)
- В metadata обидва профілі зафіксовані

**Priority:** P1

---

### US-6: Feedback Loop
> "Не так — ось так"

**Як** творець контенту,
**я хочу** сказати агенту що не так з чернеткою,
**щоб** він виправив і запам'ятав на майбутнє.

**Сценарій:**
1. Агент показує чернетку
2. Користувач: "hook слабкий, зроби провокативніше"
3. Агент перегенерує тільки hook
4. Після 5-ї генерації де користувач каже "занадто формально", агент пропонує: "Я помітив що ти часто просиш зробити менш формально. Оновити style profile?"
5. Користувач: "так" → профіль оновлюється

**Acceptance Criteria:**
- Конкретна правка → перегенерація відповідної частини (не всього тексту)
- Стильова правка → перегенерація + пропозиція оновити profile
- "ok" / "зберігай" → збереження фінальної версії
- Агент трекає повторюваний фідбек (лічильник по категоріях у `feedback-tracker.json`)
- Пропозиція оновити профіль — після 3+ схожих правок
- Оновлення тільки після явного підтвердження користувача
- Feedback loop працює ТІЛЬКИ з personal профілем. Reference профілі не оновлюються через фідбек
- Кожне оновлення профілю логується в changelog всередині profile

**Priority:** P0

---

### US-7: Аналіз контенту
> "Що працює, а що ні?"

**Як** творець контенту,
**я хочу** попросити агента проаналізувати мої пости,
**щоб** зрозуміти свої сильні та слабкі сторони.

**Сценарій:**
1. Користувач: `ghostpen analyze` (бере пости з data/examples/)
2. Агент аналізує набір постів
3. Видає звіт: найсильніші hooks, типова структура, слабкі місця, рекомендації
4. Пропонує конкретні зміни до style profile

**Acceptance Criteria:**
- Аналіз працює на 5-30 постах
- Звіт містить: патерни що працюють, що можна покращити, конкретні приклади з постів
- Рекомендації actionable ("спробуй починати з числа замість питання"), не абстрактні
- Пропозиції до profile — як diff: "додати 'числовий hook' до списку hooks"

**Priority:** P1

---

## Технічні вимоги

### Agent Core

Агент працює як autonomous loop:
```
User Input → Read Context → Plan → Execute Tools → Generate → Present → Wait for Feedback
```

- Вибір tools — автономний, Claude вирішує на основі system prompt
- Єдине hardcoded правило: ЗАВЖДИ читай style profile перед генерацією
- Всі рішення агента логуються для дебагу

### Tools

| Tool | Коли викликається | Input | Output |
|---|---|---|---|
| `read_style_profile` | Кожна генерація (обов'язково) | profile_name (default: "default") | Style Profile JSON |
| `update_style_profile` | Після підтвердженого фідбеку | profile_name + changes object | Updated profile + changelog entry |
| `list_profiles` | Коли потрібно обрати профіль | — | Список профілів з типами |
| `search_web` | Коли потрібна статистика або факти | query string | Top results |
| `read_past_posts` | Коли тема перетинається з минулими | topic keywords | Relevant posts |
| `save_to_file` | Кожна фінальна версія | content + metadata | File path |

### Stack

- **Runtime:** Node.js + TypeScript
- **AI:** Anthropic SDK (Claude 3.5/4)
- **Integrations:** Web search (Anthropic)
- **Storage:** Локальна файлова система (JSON + Markdown)
- **Залежностей мінімум:** anthropic, dotenv, chalk, commander (для CLI output)

### Performance

- Створення Style Profile: < 2 хвилини (на 15 постах)
- Генерація поста: < 30 секунд
- Feedback → перегенерація: < 15 секунд
- Mix mode генерація: < 45 секунд (два профілі в контексті)

---

## Обмеження v0.1

- Один користувач, кілька профілів (один personal + необмежено reference)
- Тільки текстовий контент (без зображень, каруселей, відео)
- Три платформи: LinkedIn, Instagram, X
- Без автоматичної публікації
- Без аналітики ефективності після публікації
- Тільки англійська та українська (мова визначається з профілю)

---

## Метрики успіху

| Метрика | Ціль |
|---|---|
| Щоденне використання | Я сам використовую це 5 днів на тиждень протягом 2 тижнів |
| Якість генерації | Чернетка потребує < 30% правок |
| Стиль | 3 з 5 людей не впізнають AI у фінальному тексті |
| Швидкість | Час створення поста скорочується вдвічі |
| Style Profile | Після 20 генерацій профіль точніше описує стиль ніж на старті |
| Mix Mode | Результат mix mode відчувається як "мій текст з новим прийомом", не як Франкенштейн |

---

## Roadmap

### v0.1 — CLI Agent (зараз)
- Персональний Style Profile creation
- Reference profiles для конкурентів
- Post generation з autonomous tool selection
- Mix mode (мій голос + чужі прийоми)
- Feedback loop з еволюцією профілю
- Локальне збереження

### v0.2 — Покращення якості
- A/B тестування hooks (агент пропонує 2-3 варіанти)
- Контент-календар (агент сам пропонує теми на тиждень)
- Multi-language support
- Покращений аналіз контенту з метриками
- Порівняльний аналіз профілів ("чим твій стиль відрізняється від Alex")

### v1.0 — Web UI + Multi-user
- Next.js інтерфейс
- Supabase auth + окремі профілі
- Командна робота (один профіль — кілька авторів)
- Інтеграція з Buffer/Later для публікації

### v2.0 — Platform
- Маркетплейс Style Profiles
- API для сторонніх інтеграцій
- Аналітика ефективності (зв'язок стиль → engagement)
- Бібліотека reference-профілів для популярних ніш